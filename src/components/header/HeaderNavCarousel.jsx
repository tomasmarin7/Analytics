import { useEffect, useMemo, useRef, useState } from "react";
import "./HeaderNavCarousel.css";

const NAV_ITEMS = [
  {
    id: "inicio",
    title: "Inicio",
    viewBox: "0 0 33 32",
    path: "M7.65479 26H12.6548V18.6667C12.6548 18.3833 12.7506 18.1458 12.9423 17.9542C13.134 17.7625 13.3715 17.6667 13.6548 17.6667H18.9881C19.2715 17.6667 19.509 17.7625 19.7006 17.9542C19.8923 18.1458 19.9881 18.3833 19.9881 18.6667V26H24.9881V13L16.3215 6.5L7.65479 13V26ZM5.65479 26V13C5.65479 12.6833 5.72562 12.3833 5.86729 12.1C6.00895 11.8167 6.20479 11.5833 6.45479 11.4L15.1215 4.9C15.4699 4.63333 15.8681 4.5 16.3161 4.5C16.7641 4.5 17.1659 4.63333 17.5215 4.9L26.1881 11.4C26.4381 11.5833 26.634 11.8167 26.7756 12.1C26.9173 12.3833 26.9881 12.6833 26.9881 13V26C26.9881 26.55 26.7923 27.0208 26.4006 27.4125C26.009 27.8042 25.5381 28 24.9881 28H18.9881C18.7048 28 18.4673 27.9042 18.2756 27.7125C18.084 27.5208 17.9881 27.2833 17.9881 27V19.6667H14.6548V27C14.6548 27.2833 14.559 27.5208 14.3673 27.7125C14.1756 27.9042 13.9381 28 13.6548 28H7.65479C7.10479 28 6.63395 27.8042 6.24229 27.4125C5.85062 27.0208 5.65479 26.55 5.65479 26Z"
  },
  {
    id: "biblioteca",
    title: "Biblioteca",
    viewBox: "0 0 33 32",
    path: "M9.231 22C10.4214 22 11.5801 22.1389 12.7071 22.4166C13.8341 22.6944 14.9421 23.1111 16.031 23.6666V9.43331C15.031 8.76665 13.9463 8.24998 12.777 7.88331C11.6077 7.51665 10.4257 7.33331 9.231 7.33331C8.38656 7.33331 7.55878 7.43887 6.74767 7.64998C5.93656 7.86109 5.11989 8.1222 4.29767 8.43331V22.9C4.98656 22.5889 5.76989 22.3611 6.64767 22.2166C7.52545 22.0722 8.38656 22 9.231 22ZM18.031 23.6666C19.1421 23.1111 20.231 22.6944 21.2977 22.4166C22.3643 22.1389 23.4977 22 24.6977 22C25.5421 22 26.4143 22.0666 27.3143 22.2C28.2143 22.3333 28.9866 22.5111 29.631 22.7333V8.43331C28.8754 8.05554 28.0774 7.77776 27.2369 7.59998C26.3964 7.4222 25.55 7.33331 24.6977 7.33331C23.4977 7.33331 22.3366 7.51665 21.2143 7.88331C20.0921 8.24998 19.031 8.76665 18.031 9.43331V23.6666ZM17.031 26.3C16.8635 26.3 16.7049 26.2833 16.5554 26.25C16.4058 26.2166 16.2754 26.1555 16.1643 26.0666C15.1199 25.4222 14.0105 24.9222 12.8361 24.5666C11.6617 24.2111 10.46 24.0333 9.231 24.0333C8.41907 24.0333 7.62165 24.1333 6.83874 24.3333C6.0558 24.5333 5.27545 24.7778 4.49767 25.0666C3.98434 25.3111 3.48934 25.2778 3.01267 24.9666C2.536 24.6555 2.29767 24.2111 2.29767 23.6333V8.19998C2.29767 7.86665 2.37545 7.56109 2.531 7.28331C2.68656 7.00554 2.91989 6.78887 3.231 6.63331C4.16434 6.18887 5.13539 5.86109 6.14417 5.64998C7.15292 5.43887 8.18187 5.33331 9.231 5.33331C10.631 5.33331 11.9921 5.5222 13.3143 5.89998C14.6366 6.27776 15.8754 6.85554 17.031 7.63331C18.1643 6.85554 19.381 6.27776 20.681 5.89998C21.981 5.5222 23.3199 5.33331 24.6977 5.33331C25.7392 5.33331 26.7607 5.43887 27.7621 5.64998C28.7636 5.86109 29.731 6.18887 30.6643 6.63331C30.9754 6.78887 31.2143 7.00554 31.381 7.28331C31.5477 7.56109 31.631 7.86665 31.631 8.19998V23.6333C31.631 24.2532 31.381 24.7248 30.881 25.0482C30.381 25.3716 29.8866 25.3778 29.3977 25.0666C28.6421 24.7555 27.8729 24.5055 27.0899 24.3166C26.307 24.1278 25.5096 24.0333 24.6977 24.0333C23.4916 24.0333 22.3123 24.2111 21.1598 24.5666C20.0073 24.9222 18.9199 25.4222 17.8977 26.0666C17.7866 26.1555 17.6562 26.2166 17.5066 26.25C17.3571 26.2833 17.1985 26.3 17.031 26.3Z"
  },
  {
    id: "estimacion",
    title: "Estimacion",
    viewBox: "0 0 33 32",
    path: "M11.0739 21.4667V23.5667C11.0739 23.8074 11.1529 24.0065 11.3111 24.1639C11.4692 24.3213 11.6692 24.4 11.9111 24.4C12.1529 24.4 12.3517 24.3213 12.5072 24.1639C12.6628 24.0065 12.7405 23.8074 12.7405 23.5667V21.4667H14.8405C15.0813 21.4667 15.2804 21.3876 15.4378 21.2295C15.5952 21.0713 15.6739 20.8713 15.6739 20.6295C15.6739 20.3876 15.5952 20.1889 15.4378 20.0333C15.2804 19.8778 15.0813 19.8 14.8405 19.8H12.7405V17.7C12.7405 17.4593 12.6615 17.2602 12.5033 17.1028C12.3452 16.9454 12.1452 16.8667 11.9033 16.8667C11.6615 16.8667 11.4628 16.9454 11.3072 17.1028C11.1517 17.2602 11.0739 17.4593 11.0739 17.7V19.8H8.97388C8.73314 19.8 8.53406 19.8791 8.37664 20.0372C8.21924 20.1954 8.14054 20.3954 8.14054 20.6372C8.14054 20.8791 8.21924 21.0778 8.37664 21.2333C8.53406 21.3889 8.73314 21.4667 8.97388 21.4667H11.0739ZM19.0739 23.2333H24.1405C24.3717 23.2333 24.5628 23.1543 24.7139 22.9961C24.865 22.838 24.9405 22.638 24.9405 22.3961C24.9405 22.1543 24.8683 21.9611 24.7239 21.8167C24.5794 21.6722 24.385 21.6 24.1405 21.6H19.0405C18.8094 21.6 18.6183 21.6722 18.4672 21.8167C18.3161 21.9611 18.2405 22.1543 18.2405 22.3961C18.2405 22.638 18.3192 22.838 18.4766 22.9961C18.6341 23.1543 18.8331 23.2333 19.0739 23.2333ZM19.0739 19.6667H24.1072C24.3479 19.6667 24.547 19.5876 24.7044 19.4295C24.8618 19.2713 24.9405 19.0713 24.9405 18.8295C24.9405 18.5876 24.8618 18.3889 24.7044 18.2333C24.547 18.0778 24.3479 18 24.1072 18H19.0739C18.8331 18 18.6341 18.0791 18.4766 18.2372C18.3192 18.3954 18.2405 18.5954 18.2405 18.8372C18.2405 19.0791 18.3192 19.2778 18.4766 19.4333C18.6341 19.5889 18.8331 19.6667 19.0739 19.6667ZM21.5072 12.2L22.9405 13.6333C23.1102 13.8111 23.3082 13.9 23.5345 13.9C23.7607 13.9 23.9628 13.8111 24.1405 13.6333C24.3183 13.4556 24.4072 13.2556 24.4072 13.0333C24.4072 12.8111 24.3183 12.6111 24.1405 12.4333L22.7072 11L24.1405 9.56667C24.3183 9.39698 24.4072 9.199 24.4072 8.97273C24.4072 8.74647 24.3183 8.54444 24.1405 8.36667C23.9628 8.18889 23.7607 8.1 23.5345 8.1C23.3082 8.1 23.1102 8.18889 22.9405 8.36667L21.5072 9.8L20.0739 8.36667C19.9042 8.18889 19.7062 8.1 19.4799 8.1C19.2537 8.1 19.0517 8.18889 18.8739 8.36667C18.6961 8.54444 18.6072 8.74647 18.6072 8.97273C18.6072 9.199 18.6961 9.39698 18.8739 9.56667L20.3072 11L18.8739 12.4333C18.6961 12.6048 18.6072 12.8048 18.6072 13.0333C18.6072 13.2619 18.6961 13.4619 18.8739 13.6333C19.0436 13.8111 19.2415 13.9 19.4678 13.9C19.6941 13.9 19.8961 13.8111 20.0739 13.6333L21.5072 12.2ZM9.47388 11.8333H14.3405C14.5813 11.8333 14.7804 11.7543 14.9378 11.5961C15.0952 11.438 15.1739 11.238 15.1739 10.9961C15.1739 10.7543 15.0952 10.5556 14.9378 10.4C14.7804 10.2444 14.5813 10.1667 14.3405 10.1667H9.47388C9.23314 10.1667 9.03406 10.2457 8.87664 10.4039C8.71924 10.562 8.64054 10.762 8.64054 11.0039C8.64054 11.2457 8.71924 11.4444 8.87664 11.6C9.03406 11.7556 9.23314 11.8333 9.47388 11.8333ZM6.60721 28C6.07387 28 5.60721 27.8 5.20721 27.4C4.80721 27 4.60721 26.5333 4.60721 26V6C4.60721 5.46667 4.80721 5 5.20721 4.6C5.60721 4.2 6.07387 4 6.60721 4H26.6072C27.1405 4 27.6072 4.2 28.0072 4.6C28.4072 5 28.6072 5.46667 28.6072 6V26C28.6072 26.5333 28.4072 27 28.0072 27.4C27.6072 27.8 27.1405 28 26.6072 28H6.60721ZM6.60721 26H26.6072V6H6.60721V26Z"
  },
  {
    id: "conteo",
    title: "Conteo",
    viewBox: "0 0 33 32",
    path: "M4.25009 9.14286C4.25009 7.77889 4.79192 6.47078 5.7564 5.50631C6.72087 4.54184 8.02897 4 9.39294 4H23.1072C24.4712 4 25.7793 4.54184 26.7438 5.50631C27.7083 6.47078 28.2501 7.77889 28.2501 9.14286V22.8571C28.2501 24.2211 27.7083 25.5292 26.7438 26.4937C25.7793 27.4582 24.4712 28 23.1072 28H9.39294C8.02897 28 6.72087 27.4582 5.7564 26.4937C4.79192 25.5292 4.25009 24.2211 4.25009 22.8571V9.14286ZM5.96437 9.14286H7.67866C7.67866 8.80186 7.81412 8.47484 8.05524 8.23372C8.29635 7.9926 8.62338 7.85714 8.96437 7.85714C9.30537 7.85714 9.63239 7.9926 9.87351 8.23372C10.1146 8.47484 10.2501 8.80186 10.2501 9.14286C10.2501 8.80186 10.3855 8.47484 10.6267 8.23372C10.8678 7.9926 11.1948 7.85714 11.5358 7.85714C11.8768 7.85714 12.2038 7.9926 12.4449 8.23372C12.6861 8.47484 12.8215 8.80186 12.8215 9.14286C12.8215 8.80186 12.957 8.47484 13.1981 8.23372C13.4392 7.9926 13.7662 7.85714 14.1072 7.85714C14.4482 7.85714 14.7752 7.9926 15.0164 8.23372C15.2575 8.47484 15.3929 8.80186 15.3929 9.14286C15.3929 8.80186 15.5284 8.47484 15.7695 8.23372C16.0106 7.9926 16.3377 7.85714 16.6787 7.85714C17.0197 7.85714 17.3467 7.9926 17.5878 8.23372C17.8289 8.47484 17.9644 8.80186 17.9644 9.14286H22.2501C22.2501 8.80186 22.3855 8.47484 22.6267 8.23372C22.8678 7.9926 23.1948 7.85714 23.5358 7.85714C23.8768 7.85714 24.2038 7.9926 24.4449 8.23372C24.6861 8.47484 24.8215 8.80186 24.8215 9.14286H26.5358C26.5358 8.23354 26.1746 7.36147 25.5316 6.71849C24.8886 6.07551 24.0165 5.71429 23.1072 5.71429H9.39294C8.48363 5.71429 7.61156 6.07551 6.96858 6.71849C6.3256 7.36147 5.96437 8.23354 5.96437 9.14286ZM22.2501 14.2857H17.9644C17.9644 14.6267 17.8289 14.9537 17.5878 15.1949C17.3467 15.436 17.0197 15.5714 16.6787 15.5714C16.3377 15.5714 16.0106 15.436 15.7695 15.1949C15.5284 14.9537 15.3929 14.6267 15.3929 14.2857C15.3929 14.6267 15.2575 14.9537 15.0164 15.1949C14.7752 15.436 14.4482 15.5714 14.1072 15.5714C13.7662 15.5714 13.4392 15.436 13.1981 15.1949C12.957 14.9537 12.8215 14.6267 12.8215 14.2857C12.8215 14.6267 12.6861 14.9537 12.4449 15.1949C12.2038 15.436 11.8768 15.5714 11.5358 15.5714C11.1948 15.5714 10.8678 15.436 10.6267 15.1949C10.3855 14.9537 10.2501 14.6267 10.2501 14.2857C10.2501 14.6267 10.1146 14.9537 9.87351 15.1949C9.63239 15.436 9.30537 15.5714 8.96437 15.5714C8.62338 15.5714 8.29635 15.436 8.05524 15.1949C7.81412 14.9537 7.67866 14.6267 7.67866 14.2857H5.96437V17.7143H7.67866C7.67866 17.3733 7.81412 17.0463 8.05524 16.8051C8.29635 16.564 8.62338 16.4286 8.96437 16.4286C9.30537 16.4286 9.63239 16.564 9.87351 16.8051C10.1146 17.0463 10.2501 17.3733 10.2501 17.7143C10.2501 17.3733 10.3855 17.0463 10.6267 16.8051C10.8678 16.564 11.1948 16.4286 11.5358 16.4286C11.8768 16.4286 12.2038 16.564 12.4449 16.8051C12.6861 17.0463 12.8215 17.3733 12.8215 17.7143C12.8215 17.3733 12.957 17.0463 13.1981 16.8051C13.4392 16.564 13.7662 16.4286 14.1072 16.4286C14.4482 16.4286 14.7752 16.564 15.0164 16.8051C15.2575 17.0463 15.3929 17.3733 15.3929 17.7143C15.3929 17.3733 15.5284 17.0463 15.7695 16.8051C16.0106 16.564 16.3377 16.4286 16.6787 16.4286C17.0197 16.4286 17.3467 16.564 17.5878 16.8051C17.8289 17.0463 17.9644 17.3733 17.9644 17.7143H22.2501C22.2501 17.3733 22.3855 17.0463 22.6267 16.8051C22.8678 16.564 23.1948 16.4286 23.5358 16.4286C23.8768 16.4286 24.2038 16.564 24.4449 16.8051C24.6861 17.0463 24.8215 17.3733 24.8215 17.7143H26.5358V14.2857H24.8215C24.8215 14.6267 24.6861 14.9537 24.4449 15.1949C24.2038 15.436 23.8768 15.5714 23.5358 15.5714C23.1948 15.5714 22.8678 15.436 22.6267 15.1949C22.3855 14.9537 22.2501 14.6267 22.2501 14.2857Z"
  },
  {
    id: "comp-industria",
    title: "Comp. Industria",
    viewBox: "0 0 33 32",
    path: "M10.9342 25.7387V21.9363H4.99496C4.55623 21.9363 4.23548 21.7434 4.03269 21.3577C3.8297 20.9719 3.8479 20.5964 4.08728 20.231L7.71952 14.6579H7.4863C7.06011 14.6579 6.74047 14.4681 6.52737 14.0886C6.31448 13.7091 6.33783 13.3366 6.59743 12.9711L11.8464 5.46885C12.0655 5.15628 12.368 5 12.7538 5C13.1395 5 13.442 5.15628 13.6611 5.46885L16.393 9.39981L19.1248 5.46885C19.344 5.15628 19.6464 5 20.0322 5C20.4179 5 20.7204 5.15628 20.9396 5.46885L26.1885 12.9711C26.4481 13.3366 26.4715 13.7091 26.2586 14.0886C26.0455 14.4681 25.7258 14.6579 25.2996 14.6579H25.0664L28.6987 20.231C28.938 20.5964 28.9562 20.9719 28.7533 21.3577C28.5505 21.7434 28.2297 21.9363 27.791 21.9363H21.8518V25.692C21.8518 26.0047 21.7472 26.2656 21.5379 26.4747C21.3289 26.6839 21.0679 26.7886 20.7552 26.7886H19.2625C18.9653 26.7886 18.716 26.6879 18.5146 26.4865C18.3133 26.2851 18.2126 26.0359 18.2126 25.7387V21.9363H14.5734V25.692C14.5734 26.0047 14.4687 26.2656 14.2595 26.4747C14.0504 26.6839 13.7895 26.7886 13.4768 26.7886H11.9841C11.6869 26.7886 11.4376 26.6879 11.2362 26.4865C11.0348 26.2851 10.9342 26.0359 10.9342 25.7387ZM21.3547 20.1167H26.4754L21.7165 12.8383H23.8534L20.0322 7.37944L17.5175 10.9674L18.9216 12.9711C19.1735 13.3366 19.195 13.7091 18.9859 14.0886C18.7767 14.4681 18.4589 14.6579 18.0327 14.6579H17.788L21.3547 20.1167ZM6.31053 20.1167H19.197L14.4381 12.8383H16.5749L12.7538 7.37944L8.93259 12.8383H11.0694L6.31053 20.1167Z"
  },
  {
    id: "rendimiento",
    title: "Rendimiento",
    viewBox: "0 0 33 32",
    path: "M2.99485 23.553C2.76914 23.4001 2.63458 23.1919 2.59118 22.9285C2.54778 22.6651 2.59275 22.4223 2.72608 22.2001L7.75942 14.1667C7.93719 13.8779 8.1983 13.7223 8.54275 13.7001C8.88719 13.6779 9.17053 13.789 9.39275 14.0334L12.4927 17.6667L16.9927 10.4001C17.1705 10.089 17.4427 9.92786 17.8094 9.91675C18.1761 9.90564 18.4594 10.0556 18.6594 10.3667L20.6594 13.3334C20.8372 13.6001 20.8927 13.8612 20.8261 14.1167C20.7594 14.3723 20.615 14.5667 20.3927 14.7001C20.1705 14.8334 19.9282 14.8876 19.6658 14.8626C19.4033 14.8376 19.179 14.6834 18.9927 14.4001L17.8927 12.7334L13.5261 19.8667C13.3483 20.1556 13.0872 20.3112 12.7427 20.3334C12.3983 20.3556 12.115 20.2445 11.8927 20.0001L8.75942 16.3334L4.42608 23.2667C4.27053 23.5112 4.05386 23.6667 3.77608 23.7334C3.4983 23.8001 3.23792 23.74 2.99485 23.553ZM22.4594 27.7334C20.8853 27.7334 19.5474 27.1821 18.4455 26.0795C17.3437 24.9769 16.7927 23.638 16.7927 22.0628C16.7927 20.4877 17.3441 19.1501 18.4467 18.0501C19.5493 16.9501 20.8882 16.4001 22.4634 16.4001C24.0385 16.4001 25.3761 16.951 26.4761 18.0528C27.5761 19.1547 28.1261 20.4927 28.1261 22.0667C28.1261 22.6445 28.0316 23.2056 27.8428 23.7501C27.6539 24.2945 27.4039 24.8112 27.0928 25.3001L30.8261 29.0334C31.0312 29.2334 31.1381 29.4667 31.1466 29.7334C31.1551 30.0001 31.0588 30.2334 30.8577 30.4334C30.6565 30.6334 30.4176 30.7334 30.141 30.7334C29.8644 30.7334 29.6261 30.6334 29.4261 30.4334L25.6594 26.7001C25.1928 27.0334 24.6872 27.289 24.1427 27.4667C23.5983 27.6445 23.0372 27.7334 22.4594 27.7334ZM22.4547 25.7334C23.4801 25.7334 24.3483 25.3794 25.0594 24.6714C25.7705 23.9635 26.1261 23.0968 26.1261 22.0714C26.1261 21.0461 25.7721 20.1779 25.0641 19.4667C24.3561 18.7556 23.4895 18.4001 22.4641 18.4001C21.4388 18.4001 20.5705 18.7541 19.8594 19.462C19.1483 20.17 18.7927 21.0367 18.7927 22.062C18.7927 23.0874 19.1467 23.9556 19.8547 24.6667C20.5627 25.3779 21.4294 25.7334 22.4547 25.7334Z"
  },
  {
    id: "mapa",
    title: "Mapa",
    viewBox: "0 0 33 32",
    path: "M3.20251 16.5C3.20251 14.6556 3.55251 12.9222 4.25251 11.3C4.95251 9.6778 5.90251 8.26669 7.10251 7.06669C8.30252 5.86669 9.71363 4.91669 11.3358 4.21669C12.9581 3.51669 14.6914 3.16669 16.5358 3.16669C19.5803 3.16669 22.2636 4.05558 24.5858 5.83335C26.9081 7.61113 28.4803 9.88891 29.3025 12.6667C29.3914 12.9556 29.3692 13.2278 29.2358 13.4834C29.1025 13.7389 28.8927 13.9031 28.6065 13.9758C28.3372 14.0364 28.0914 13.9834 27.8692 13.8167C27.647 13.65 27.4914 13.4334 27.4025 13.1667C26.9136 11.5222 26.0914 10.0611 24.9358 8.78335C23.7803 7.50558 22.3914 6.53335 20.7692 5.86669V6.46669C20.7692 7.24446 20.5025 7.92224 19.9692 8.50002C19.4358 9.0778 18.7803 9.36669 18.0025 9.36669H15.1025V12.2667C15.1025 12.635 14.9525 12.9438 14.6525 13.1929C14.3525 13.4421 14.0136 13.5667 13.6358 13.5667H10.8692V16.5H13.5358C13.8192 16.5 14.0567 16.5959 14.2483 16.7875C14.44 16.9792 14.5358 17.2167 14.5358 17.5V20.6667H12.3025L5.50251 13.8667C5.3914 14.3111 5.31363 14.7519 5.26918 15.1889C5.22474 15.6259 5.20251 16.063 5.20251 16.5C5.20251 19.3449 6.11918 21.8284 7.95252 23.9504C9.78585 26.0724 12.1025 27.3222 14.9025 27.7C15.162 27.7374 15.3768 27.8634 15.5471 28.078C15.7174 28.2927 15.8025 28.5389 15.8025 28.8167C15.8025 29.0945 15.7009 29.3222 15.4978 29.5C15.2947 29.6778 15.0518 29.7445 14.7692 29.7C11.4803 29.2556 8.73029 27.7945 6.51918 25.3167C4.30807 22.8389 3.20251 19.9 3.20251 16.5ZM28.1692 28.2L24.4025 24.4667C23.9358 24.8 23.4303 25.0556 22.8858 25.2334C22.3414 25.4111 21.7851 25.5 21.217 25.5C19.6389 25.5 18.2975 24.9487 17.1928 23.8461C16.0882 22.7435 15.5358 21.4046 15.5358 19.8294C15.5358 18.2543 16.0872 16.9167 17.1898 15.8167C18.2924 14.7167 19.6313 14.1667 21.2064 14.1667C22.7816 14.1667 24.1192 14.719 25.2192 15.8237C26.3192 16.9284 26.8692 18.2697 26.8692 19.8479C26.8692 20.416 26.7747 20.9722 26.5858 21.5167C26.397 22.0611 26.147 22.5778 25.8358 23.0667L29.5692 26.8C29.7692 27 29.8747 27.2334 29.8858 27.5C29.897 27.7667 29.8025 28 29.6025 28.2C29.4025 28.4 29.1636 28.5 28.8858 28.5C28.6081 28.5 28.3692 28.4 28.1692 28.2Z"
  },
  {
    id: "clima",
    title: "Clima",
    viewBox: "0 0 33 32",
    path: "M16.4586 6.83331C16.1736 6.83331 15.9367 6.73748 15.7478 6.54581C15.5589 6.35415 15.4645 6.11665 15.4645 5.83331V2.83331C15.4645 2.54998 15.5608 2.31248 15.7536 2.12081C15.9464 1.92915 16.1853 1.83331 16.4703 1.83331C16.7553 1.83331 16.9922 1.92915 17.1811 2.12081C17.37 2.31248 17.4645 2.54998 17.4645 2.83331V5.83331C17.4645 6.11665 17.3681 6.35415 17.1753 6.54581C16.9825 6.73748 16.7436 6.83331 16.4586 6.83331ZM23.2978 9.66665C23.0978 9.46665 22.9978 9.2322 22.9978 8.96331C22.9978 8.69443 23.0978 8.4622 23.2978 8.26665L25.3978 6.13331C25.5993 5.93331 25.8385 5.83331 26.1156 5.83331C26.3926 5.83331 26.6311 5.93331 26.8311 6.13331C27.0311 6.33331 27.1311 6.56665 27.1311 6.83331C27.1311 7.09998 27.0311 7.33331 26.8311 7.53331L24.6978 9.66665C24.4978 9.86665 24.2645 9.96665 23.9978 9.96665C23.7311 9.96665 23.4978 9.86665 23.2978 9.66665ZM27.1311 17.5C26.8478 17.5 26.6103 17.4036 26.4186 17.2108C26.227 17.018 26.1311 16.7791 26.1311 16.4941C26.1311 16.2091 26.227 15.9722 26.4186 15.7833C26.6103 15.5944 26.8478 15.5 27.1311 15.5H30.1311C30.4145 15.5 30.652 15.5964 30.8436 15.7891C31.0353 15.9819 31.1311 16.2208 31.1311 16.5058C31.1311 16.7908 31.0353 17.0278 30.8436 17.2166C30.652 17.4055 30.4145 17.5 30.1311 17.5H27.1311ZM16.4586 31.1666C16.1736 31.1666 15.9367 31.0708 15.7478 30.8791C15.5589 30.6875 15.4645 30.45 15.4645 30.1666V27.1666C15.4645 26.8833 15.5608 26.6458 15.7536 26.4541C15.9464 26.2625 16.1853 26.1666 16.4703 26.1666C16.7553 26.1666 16.9922 26.2625 17.1811 26.4541C17.37 26.6458 17.4645 26.8833 17.4645 27.1666V30.1666C17.4645 30.45 17.3681 30.6875 17.1753 30.8791C16.9825 31.0708 16.7436 31.1666 16.4586 31.1666ZM8.23112 9.66665L6.09779 7.56665C5.89779 7.36954 5.79779 7.13137 5.79779 6.85215C5.79779 6.57292 5.90214 6.33331 6.11082 6.13331C6.30214 5.93331 6.53112 5.83331 6.79779 5.83331C7.06446 5.83331 7.29779 5.93331 7.49779 6.13331L9.63112 8.26665C9.83112 8.46665 9.93112 8.69998 9.93112 8.96665C9.93112 9.23331 9.83112 9.46665 9.63112 9.66665C9.42506 9.84442 9.18466 9.93331 8.90992 9.93331C8.63517 9.93331 8.4089 9.84442 8.23112 9.66665ZM25.4311 26.8666L23.2978 24.7333C23.0978 24.5378 22.9978 24.3055 22.9978 24.0366C22.9978 23.7678 23.0978 23.5333 23.2978 23.3333C23.4811 23.1555 23.7103 23.0666 23.9853 23.0666C24.2603 23.0666 24.4978 23.1555 24.6978 23.3333L26.8645 25.4333C27.0645 25.6333 27.1603 25.8733 27.1521 26.1534C27.1439 26.4335 27.0491 26.6724 26.8679 26.8701C26.6702 27.0678 26.4313 27.1666 26.1512 27.1666C25.8712 27.1666 25.6311 27.0666 25.4311 26.8666ZM2.79779 17.5C2.51446 17.5 2.27696 17.4036 2.08529 17.2108C1.89362 17.018 1.79779 16.7791 1.79779 16.4941C1.79779 16.2091 1.89362 15.9722 2.08529 15.7833C2.27696 15.5944 2.51446 15.5 2.79779 15.5H5.79779C6.08112 15.5 6.31862 15.5964 6.51029 15.7891C6.70196 15.9819 6.79779 16.2208 6.79779 16.5058C6.79779 16.7908 6.70196 17.0278 6.51029 17.2166C6.31862 17.4055 6.08112 17.5 5.79779 17.5H2.79779ZM16.4645 24.5C14.2422 24.5 12.3533 23.7222 10.7978 22.1666C9.24224 20.6111 8.46446 18.7222 8.46446 16.5C8.46446 14.2778 9.24224 12.3889 10.7978 10.8333C12.3533 9.27776 14.2422 8.49998 16.4645 8.49998C18.6867 8.49998 20.5756 9.27776 22.1311 10.8333C23.6867 12.3889 24.4645 14.2778 24.4645 16.5C24.4645 18.7222 23.6867 20.6111 22.1311 22.1666C20.5756 23.7222 18.6867 24.5 16.4645 24.5Z"
  },
  {
    id: "riego",
    title: "Riego",
    viewBox: "0 0 33 32",
    path: "M12 22C9.71667 22 7.8125 21.2167 6.2875 19.65C4.7625 18.0833 4 16.1333 4 13.8C4 12.7333 4.24167 11.675 4.725 10.625C5.20833 9.575 5.8125 8.56667 6.5375 7.6C7.2625 6.63333 8.04583 5.72917 8.8875 4.8875C9.72917 4.04583 10.5167 3.3 11.25 2.65C11.3667 2.55 11.4875 2.47917 11.6125 2.4375C11.7375 2.39583 11.8667 2.375 12 2.375C12.1333 2.375 12.2625 2.39583 12.3875 2.4375C12.5125 2.47917 12.6333 2.55 12.75 2.65C13.4833 3.3 14.2708 4.04583 15.1125 4.8875C15.9542 5.72917 16.7375 6.63333 17.4625 7.6C18.1875 8.56667 18.7917 9.575 19.275 10.625C19.7583 11.675 20 12.7333 20 13.8C20 16.1333 19.2375 18.0833 17.7125 19.65C16.1875 21.2167 14.2833 22 12 22ZM12 20.5C13.8667 20.5 15.4167 19.8625 16.65 18.5875C17.8833 17.3125 18.5 15.7167 18.5 13.8C18.5 12.4833 17.9458 10.9875 16.8375 9.3125C15.7292 7.6375 14.1167 5.86667 12 4C9.88333 5.86667 8.27083 7.6375 7.1625 9.3125C6.05417 10.9875 5.5 12.4833 5.5 13.8C5.5 15.7167 6.11667 17.3125 7.35 18.5875C8.58333 19.8625 10.1333 20.5 12 20.5Z"
  },
  {
    id: "nutricion",
    title: "Nutricion",
    viewBox: "0 0 33 32",
    path: "M11.9956 20.75C11.7819 20.75 11.6042 20.6781 11.4625 20.5344C11.3208 20.3906 11.25 20.2125 11.25 20V13.025H10.75C9.68333 13.025 8.67917 12.8208 7.7375 12.4125C6.79583 12.0042 5.95833 11.425 5.225 10.675C4.49167 9.925 3.9375 9.05833 3.5625 8.075C3.1875 7.09167 3 6.06667 3 5V3.75C3 3.5375 3.07187 3.35938 3.21563 3.21563C3.35938 3.07187 3.5375 3 3.75 3H4.95C5.98333 3 6.975 3.20417 7.925 3.6125C8.875 4.02083 9.725 4.6 10.475 5.35C11.025 5.91667 11.4792 6.55 11.8375 7.25C12.1958 7.95 12.45 8.69167 12.6 9.475C12.7275 9.27667 12.8676 9.08542 13.0206 8.90125C13.1735 8.71708 13.3333 8.53333 13.5 8.35C14.25 7.6 15.1 7.02083 16.05 6.6125C17 6.20417 18 6 19.05 6H20.25C20.4625 6 20.6406 6.07188 20.7844 6.21563C20.9281 6.35938 21 6.5375 21 6.75V8C21 9.06667 20.8002 10.0917 20.4005 11.075C20.0009 12.0583 19.434 12.925 18.7 13.675C17.95 14.425 17.1037 15 16.161 15.4C15.2183 15.8 14.2313 16 13.2 16H12.75V20C12.75 20.2125 12.6777 20.3906 12.5331 20.5344C12.3885 20.6781 12.2094 20.75 11.9956 20.75ZM11.275 11.5C11.275 10.4833 11.1083 9.5375 10.775 8.6625C10.4417 7.7875 9.98333 7.04583 9.4 6.4375C8.81667 5.82917 8.1 5.35417 7.25 5.0125C6.4 4.67083 5.48333 4.5 4.5 4.5C4.5 5.55 4.65417 6.5125 4.9625 7.3875C5.27083 8.2625 5.71667 9.00833 6.3 9.625C7 10.375 7.75417 10.875 8.5625 11.125C9.37083 11.375 10.275 11.5 11.275 11.5ZM12.75 14.5C13.75 14.5 14.675 14.3375 15.525 14.0125C16.375 13.6875 17.0917 13.2208 17.675 12.6125C18.2583 12.0042 18.7083 11.2625 19.025 10.3875C19.3417 9.5125 19.5 8.55 19.5 7.5C18.5 7.5 17.575 7.67083 16.725 8.0125C15.875 8.35417 15.1583 8.825 14.575 9.425C13.8583 10.175 13.375 10.9583 13.125 11.775C12.875 12.5917 12.75 13.5 12.75 14.5Z"
  },
  {
    id: "plan-cosecha",
    title: "Pla. Cosecha",
    viewBox: "0 0 33 32",
    path: "M6.39294 28C5.84294 28 5.37211 27.8041 4.98044 27.4125C4.58878 27.0208 4.39294 26.55 4.39294 26V5.99998C4.39294 5.44998 4.58878 4.97915 4.98044 4.58748C5.37211 4.19581 5.84294 3.99998 6.39294 3.99998H13.2263C13.3374 3.2222 13.6929 2.58331 14.2929 2.08331C14.8929 1.58331 15.5929 1.33331 16.3929 1.33331C17.1929 1.33331 17.8929 1.58331 18.4929 2.08331C19.0929 2.58331 19.4485 3.2222 19.5596 3.99998H26.3929C26.9429 3.99998 27.4138 4.19581 27.8054 4.58748C28.1971 4.97915 28.3929 5.44998 28.3929 5.99998V26C28.3929 26.55 28.1971 27.0208 27.8054 27.4125C27.4138 27.8041 26.9429 28 26.3929 28H6.39294ZM6.39294 26H26.3929V5.99998H6.39294V26ZM10.7263 22.6666H17.8263C18.1096 22.6666 18.3471 22.5703 18.5388 22.3775C18.7304 22.1847 18.8263 21.9458 18.8263 21.6608C18.8263 21.3758 18.7304 21.1389 18.5388 20.95C18.3471 20.7611 18.1096 20.6666 17.8263 20.6666H10.7263C10.4429 20.6666 10.2054 20.763 10.0138 20.9558C9.82211 21.1486 9.72628 21.3875 9.72628 21.6725C9.72628 21.9575 9.82211 22.1944 10.0138 22.3833C10.2054 22.5722 10.4429 22.6666 10.7263 22.6666ZM10.7263 17H22.0596C22.3429 17 22.5804 16.9036 22.7721 16.7108C22.9638 16.518 23.0596 16.2791 23.0596 15.9941C23.0596 15.7091 22.9638 15.4722 22.7721 15.2833C22.5804 15.0944 22.3429 15 22.0596 15H10.7263C10.4429 15 10.2054 15.0964 10.0138 15.2891C9.82211 15.4819 9.72628 15.7208 9.72628 16.0058C9.72628 16.2908 9.82211 16.5278 10.0138 16.7166C10.2054 16.9055 10.4429 17 10.7263 17ZM10.7263 11.3333H22.0596C22.3429 11.3333 22.5804 11.2369 22.7721 11.0441C22.9638 10.8513 23.0596 10.6125 23.0596 10.3275C23.0596 10.0425 22.9638 9.80553 22.7721 9.61665C22.5804 9.42776 22.3429 9.33331 22.0596 9.33331H10.7263C10.4429 9.33331 10.2054 9.4297 10.0138 9.62248C9.82211 9.81528 9.72628 10.0542 9.72628 10.3391C9.72628 10.6241 9.82211 10.8611 10.0138 11.05C10.2054 11.2389 10.4429 11.3333 10.7263 11.3333ZM16.3929 5.43331C16.7041 5.43331 16.9763 5.31665 17.2096 5.08331C17.4429 4.84998 17.5596 4.57776 17.5596 4.26665C17.5596 3.95554 17.4429 3.68331 17.2096 3.44998C16.9763 3.21665 16.7041 3.09998 16.3929 3.09998C16.0818 3.09998 15.8096 3.21665 15.5763 3.44998C15.3429 3.68331 15.2263 3.95554 15.2263 4.26665C15.2263 4.57776 15.3429 4.84998 15.5763 5.08331C15.8096 5.31665 16.0818 5.43331 16.3929 5.43331Z"
  },
  {
    id: "usabilidad",
    title: "Usabilidad",
    viewBox: "0 0 33 32",
    path: "M16.7501 23.9334C15.2612 23.9334 13.8279 24.1945 12.4501 24.7167C11.0723 25.2389 9.78344 26.0111 8.58344 27.0334V27.3334H24.9168V27.0334C23.7168 26.0111 22.4279 25.2389 21.0501 24.7167C19.6723 24.1945 18.239 23.9334 16.7501 23.9334ZM16.7501 21.9334C18.3945 21.9334 19.9445 22.2056 21.4001 22.75C22.8557 23.2945 24.1945 24.0334 25.4168 24.9667V4.66669H8.08344V24.9667C9.30566 24.0334 10.6445 23.2945 12.1001 22.75C13.5557 22.2056 15.1057 21.9334 16.7501 21.9334ZM16.8168 17.3C16.0945 17.3 15.4807 17.0472 14.9751 16.5417C14.4695 16.0361 14.2168 15.4222 14.2168 14.7C14.2168 13.9778 14.4695 13.3639 14.9751 12.8584C15.4807 12.3528 16.0945 12.1 16.8168 12.1C17.539 12.1 18.1529 12.3528 18.6584 12.8584C19.164 13.3639 19.4168 13.9778 19.4168 14.7C19.4168 15.4222 19.164 16.0361 18.6584 16.5417C18.1529 17.0472 17.539 17.3 16.8168 17.3ZM8.08344 29.3334C7.5501 29.3334 7.08344 29.1334 6.68344 28.7334C6.28344 28.3334 6.08344 27.8667 6.08344 27.3334V4.66669C6.08344 4.13335 6.28344 3.66669 6.68344 3.26669C7.08344 2.86669 7.5501 2.66669 8.08344 2.66669H25.4168C25.9501 2.66669 26.4168 2.86669 26.8168 3.26669C27.2168 3.66669 27.4168 4.13335 27.4168 4.66669V27.3334C27.4168 27.8667 27.2168 28.3334 26.8168 28.7334C26.4168 29.1334 25.9501 29.3334 25.4168 29.3334H8.08344ZM16.8168 19.3C18.1057 19.3 19.1945 18.8556 20.0834 17.9667C20.9723 17.0778 21.4168 15.9889 21.4168 14.7C21.4168 13.4111 20.9723 12.3222 20.0834 11.4334C19.1945 10.5445 18.1057 10.1 16.8168 10.1C15.5279 10.1 14.439 10.5445 13.5501 11.4334C12.6612 12.3222 12.2168 13.4111 12.2168 14.7C12.2168 15.9889 12.6612 17.0778 13.5501 17.9667C14.439 18.8556 15.5279 19.3 16.8168 19.3Z"
  }
];

const LOOP_COPIES = 3;

const HeaderNavCarousel = () => {
  const scrollerRef = useRef(null);
  const itemRefs = useRef([]);
  const segmentWidthRef = useRef(0);
  const dragDataRef = useRef({ active: false, moved: false, startX: 0, startScrollLeft: 0 });
  const [activeIndex, setActiveIndex] = useState(0);

  const items = useMemo(() => NAV_ITEMS, []);
  const loopedItems = useMemo(
    () =>
      Array.from({ length: LOOP_COPIES }, (_, copy) =>
        items.map((item, index) => ({
          ...item,
          baseIndex: index,
          loopIndex: copy * items.length + index
        }))
      ).flat(),
    [items]
  );

  const centerItemAtIndex = (targetIndex) => {
    const scroller = scrollerRef.current;
    const targetItem = itemRefs.current[targetIndex];
    if (!scroller || !targetItem) {
      return;
    }

    const targetLeft = targetItem.offsetLeft - (scroller.clientWidth - targetItem.clientWidth) / 2;
    scroller.scrollLeft = targetLeft;
  };

  const getClosestLoopIndexForBase = (baseIndex) => {
    const scroller = scrollerRef.current;
    if (!scroller) {
      return items.length + baseIndex;
    }

    const viewportCenter = scroller.scrollLeft + scroller.clientWidth / 2;
    let bestIndex = items.length + baseIndex;
    let bestDistance = Number.POSITIVE_INFINITY;

    for (let copy = 0; copy < LOOP_COPIES; copy += 1) {
      const loopIndex = copy * items.length + baseIndex;
      const node = itemRefs.current[loopIndex];
      if (!node) {
        continue;
      }

      const nodeCenter = node.offsetLeft + node.clientWidth / 2;
      const distance = Math.abs(nodeCenter - viewportCenter);
      if (distance < bestDistance) {
        bestDistance = distance;
        bestIndex = loopIndex;
      }
    }

    return bestIndex;
  };

  const selectBaseIndex = (baseIndex) => {
    if (Number.isNaN(baseIndex)) {
      return;
    }

    const target = getClosestLoopIndexForBase(baseIndex);
    setActiveIndex(baseIndex);
    centerItemAtIndex(target);
  };

  const measureSegmentWidth = () => {
    const first = itemRefs.current[0];
    const secondLoopFirst = itemRefs.current[items.length];
    if (!first || !secondLoopFirst) {
      return;
    }

    segmentWidthRef.current = secondLoopFirst.offsetLeft - first.offsetLeft;
  };

  const normalizeLoopPosition = () => {
    const scroller = scrollerRef.current;
    const segmentWidth = segmentWidthRef.current;
    if (!scroller || !segmentWidth) {
      return;
    }

    if (scroller.scrollLeft < segmentWidth * 0.5) {
      scroller.scrollLeft += segmentWidth;
    } else if (scroller.scrollLeft > segmentWidth * 1.5) {
      scroller.scrollLeft -= segmentWidth;
    }
  };

  const applyOpacityByCenter = () => {
    const scroller = scrollerRef.current;
    if (!scroller) {
      return;
    }

    const rect = scroller.getBoundingClientRect();
    const centerX = rect.left + rect.width / 2;
    const maxDistance = Math.max(rect.width / 2, 1);

    itemRefs.current.forEach((item, index) => {
      if (!item) {
        return;
      }

      const loopedItem = loopedItems[index];
      const isActive = loopedItem?.baseIndex === activeIndex;
      const itemRect = item.getBoundingClientRect();
      const itemCenter = itemRect.left + itemRect.width / 2;
      const distance = Math.min(Math.abs(centerX - itemCenter) / maxDistance, 1);

      // The selected option must remain visually strong regardless of distance.
      const opacity = isActive ? 1 : Math.max(0.2, 1 - distance * 0.8);
      const scale = isActive ? 1 : 1 - distance * 0.08;

      item.style.setProperty("--item-opacity", opacity.toFixed(3));
      item.style.setProperty("--item-scale", scale.toFixed(3));
    });
  };

  useEffect(() => {
    const scroller = scrollerRef.current;
    if (!scroller) {
      return undefined;
    }

    const onResize = () => {
      measureSegmentWidth();
      centerItemAtIndex(items.length + activeIndex);
      requestAnimationFrame(applyOpacityByCenter);
    };

    const onScroll = () => {
      normalizeLoopPosition();
      requestAnimationFrame(applyOpacityByCenter);
    };

    requestAnimationFrame(() => {
      measureSegmentWidth();
      centerItemAtIndex(items.length + activeIndex);
      applyOpacityByCenter();
    });

    scroller.addEventListener("scroll", onScroll, { passive: true });
    window.addEventListener("resize", onResize);

    return () => {
      scroller.removeEventListener("scroll", onScroll);
      window.removeEventListener("resize", onResize);
    };
  }, [activeIndex, items.length]);

  useEffect(() => {
    requestAnimationFrame(applyOpacityByCenter);
  }, [activeIndex]);

  const handlePointerDown = (event) => {
    const scroller = scrollerRef.current;
    if (!scroller) {
      return;
    }

    dragDataRef.current = {
      active: true,
      moved: false,
      startX: event.clientX,
      startScrollLeft: scroller.scrollLeft
    };

    scroller.classList.add("header-nav__track--dragging");
    scroller.setPointerCapture(event.pointerId);
  };

  const handlePointerMove = (event) => {
    const scroller = scrollerRef.current;
    if (!scroller || !dragDataRef.current.active) {
      return;
    }

    const dx = event.clientX - dragDataRef.current.startX;
    if (Math.abs(dx) > 4) {
      dragDataRef.current.moved = true;
    }
    scroller.scrollLeft = dragDataRef.current.startScrollLeft - dx;
  };

  const releaseDrag = (event, shouldSelect = true) => {
    const scroller = scrollerRef.current;
    if (!scroller) {
      return;
    }

    const wasMoved = dragDataRef.current.moved;
    dragDataRef.current.active = false;
    dragDataRef.current.moved = false;
    scroller.classList.remove("header-nav__track--dragging");

    if (event.pointerId !== undefined && scroller.hasPointerCapture(event.pointerId)) {
      scroller.releasePointerCapture(event.pointerId);
    }

    if (!wasMoved && shouldSelect) {
      const clickedElement = document.elementFromPoint(event.clientX, event.clientY);
      const clickedButton = clickedElement?.closest?.(".header-nav__item");
      if (clickedButton) {
        const base = Number(clickedButton.getAttribute("data-base-index"));
        selectBaseIndex(base);
      }
    }

    normalizeLoopPosition();
  };

  return (
    <nav className="header-nav" aria-label="Navegacion principal">
      <div
        className="header-nav__track"
        ref={scrollerRef}
        onPointerDown={handlePointerDown}
        onPointerMove={handlePointerMove}
        onPointerUp={(event) => releaseDrag(event, true)}
        onPointerCancel={(event) => releaseDrag(event, false)}
      >
        {loopedItems.map((item, index) => (
          <button
            key={`${item.id}-${item.loopIndex}`}
            type="button"
            className={`header-nav__item${activeIndex === item.baseIndex ? " header-nav__item--active" : ""}`}
            data-base-index={item.baseIndex}
            onClick={() => selectBaseIndex(item.baseIndex)}
            ref={(node) => {
              itemRefs.current[index] = node;
            }}
          >
            <svg className="header-nav__icon" viewBox={item.viewBox} aria-hidden="true" focusable="false">
              <path fillRule="evenodd" clipRule="evenodd" d={item.path} />
            </svg>
            <span className="header-nav__title">{item.title}</span>
          </button>
        ))}
      </div>
    </nav>
  );
};

export default HeaderNavCarousel;
